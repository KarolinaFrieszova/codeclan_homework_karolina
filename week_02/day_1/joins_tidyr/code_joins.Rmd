---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)
```

```{r}
card_base <- read_csv("data/CardBase.csv")
customer_base <- read_csv("data/CustomerBase.csv")
fraud_base <- read_csv("data/FraudBase.csv")
transaction_base <- read_csv("data/TransactionBase.csv")
```

```{r}
card_base <- clean_names(card_base)
customer_base <- clean_names(customer_base)
fraud_base <- clean_names(fraud_base)
transaction_base <- clean_names(transaction_base)
```

Join the data containing card details and customer details by customer id, so that all records of card details and any matching records in customer details are kept. Before you run the code, think about how many rows you expect to see after joining.

```{r}
left_join(card_base, customer_base, by = "cust_id")
```
Join the data containing fraud details with transaction details so all rows of both tables are kept. What does the resulting row number tell you?

```{r}
fraud_transaction <- full_join(fraud_base,transaction_base, by = "transaction_id")
nrow(fraud_transaction)
nrow(fraud_base) #109 fraud_base
nrow(transaction_base) # 1000 transaction_base
```

```{r}
#card_base & transaction_base
semi_join(card_base, transaction_base, by = c("card_number" = "credit_card_id"))

```

```{r}
card_custumer <- left_join(card_base, customer_base, by = "cust_id") %>% view
card_customer_transaction <- left_join(card_custumer, transaction_base, by = c("card_number" = "credit_card_id")) %>% view
card_cust_transaction_fraud <- right_join(card_customer_transaction, fraud_base, by = "transaction_id") %>% view
```




